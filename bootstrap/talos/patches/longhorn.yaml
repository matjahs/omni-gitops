---
cluster:
  inlineManifests:
    - name: longhorn
      contents: |-
        apiVersion: v1
        kind: Namespace
        metadata:
          name: longhorn-system
        ---
        apiVersion: v1
        kind: ServiceAccount
        metadata:
          name: longhorn-service-account
          namespace: longhorn-system
        ---
        apiVersion: rbac.authorization.k8s.io/v1
        kind: ClusterRole
        metadata:
          name: longhorn-role
        rules:
          - apiGroups: [""]
            resources: ["pods", "services", "services/finalizers", "endpoints", "persistentvolumeclaims", "events", "configmaps", "secrets"]
            verbs: ["*"]
          - apiGroups: ["apps"]
            resources: ["daemonsets", "deployments", "replicasets", "statefulsets"]
            verbs: ["*"]
          - apiGroups: ["policy"]
            resources: ["poddisruptionbudgets"]
            verbs: ["*"]
          - apiGroups: ["storage.k8s.io"]
            resources: ["storageclasses", "csinodes", "csidrivers"]
            verbs: ["*"]
          - apiGroups: ["apps"]
            resourceNames: ["longhorn-driver-deployer"]
            resources: ["daemonsets/finalizers"]
            verbs: ["update"]
          - apiGroups: ["coordination.k8s.io"]
            resources: ["leases"]
            verbs: ["*"]
          - apiGroups: ["batch"]
            resources: ["jobs"]
            verbs: ["*"]
          - apiGroups: ["extensions"]
            resources: ["ingresses"]
            verbs: ["*"]
          - apiGroups: ["networking.k8s.io"]
            resources: ["ingresses", "networkpolicies"]
            verbs: ["*"]
          - apiGroups: ["apps"]
            resourceNames: ["longhorn-ui", "longhorn-backend", "longhorn-driver-deployer"]
            resources: ["deployments/finalizers"]
            verbs: ["update"]
          - apiGroups: [""]
            resourceNames: ["longhorn-service-account"]
            resources: ["serviceaccounts/finalizers"]
            verbs: ["update"]
          - apiGroups: [""]
            resourceNames: ["longhorn-system"]
            resources: ["namespaces/finalizers"]
            verbs: ["update"]
          - apiGroups: ["storage.k8s.io"]
            resourceNames: ["longhorn-csi-plugin"]
            resources: ["csidrivers/finalizers"]
            verbs: ["update"]
